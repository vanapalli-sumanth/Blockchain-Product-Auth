<!DOCTYPE html>
<html lang="en">
<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>{% block title %}BlockAuth{% endblock %}</title>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

<!-- FONT AWESOME -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">


<style>

/* CENTER NOTIFICATION CARD */

.flash-wrapper{

position:fixed;

top:50%;

left:50%;

transform:translate(-50%,-50%);

z-index:9999;

width:100%;

display:flex;

justify-content:center;

pointer-events:none;

}


.flash-card{

background:white;

padding:28px 35px;

border-radius:14px;

box-shadow:0 15px 40px rgba(0,0,0,0.15);

text-align:center;

min-width:320px;

animation:fadeIn .3s ease;

pointer-events:auto;

}


.flash-icon{

width:70px;

height:70px;

border-radius:50%;

display:flex;

align-items:center;

justify-content:center;

margin:auto;

margin-bottom:15px;

color:white;

font-size:28px;

}


/* SUCCESS */

.flash-success{
background:#16a34a;
}


/* ERROR */

.flash-danger{
background:#dc2626;
}


/* INFO */

.flash-info{
background:#0b2a6e;
}


@keyframes fadeIn{

from{
opacity:0;
transform:translateY(20px);
}

to{
opacity:1;
transform:translateY(0);
}

}

</style>

</head>

<body class="d-flex flex-column min-vh-100">


<!-- ================= NAVBAR ================= -->

<nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm fixed-top">

<div class="container">

<a class="navbar-brand fw-bold" href="/">BlockAuth</a>

<button class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#nav">
<span class="navbar-toggler-icon"></span>
</button>

<div class="collapse navbar-collapse" id="nav">

<ul class="navbar-nav ms-auto">

<li class="nav-item">
<a class="nav-link" href="/">Home</a>
</li>

<li class="nav-item">
<a class="nav-link" href="#" onclick="handleVerifyClick()">Verify</a>
</li>

{% if session.get("user") %}

{% if session.get("role")=="manufacturer" %}
<li class="nav-item">
<a class="nav-link" href="/manufacturer/dashboard">Dashboard</a>
</li>
{% endif %}

{% if session.get("role")=="customer" %}
<li class="nav-item">
<a class="nav-link" href="/customer/dashboard">Dashboard</a>
</li>
{% endif %}

{% if session.get("role")=="admin" %}
<li class="nav-item">
<a class="nav-link text-danger fw-bold" href="/admin/dashboard">
Admin Panel
</a>
</li>
{% endif %}

<li class="nav-item ms-3">
<span class="nav-link fw-bold">
ðŸ‘¤ {{session.get("user")}}
</span>
</li>

<li class="nav-item ms-2">
<a class="btn btn-outline-dark btn-sm" href="/logout">
Logout
</a>
</li>

{% else %}

<li class="nav-item">
<a class="nav-link" href="/login">Login</a>
</li>

<li class="nav-item">
<a class="nav-link" href="/register">Register</a>
</li>

{% endif %}

</ul>

</div>
</div>
</nav>



<!-- ================= CONTENT ================= -->

<main class="flex-fill page-content">

{% block content %}{% endblock %}

</main>



<!-- ================= CENTER FLASH NOTIFICATION ================= -->

{% with messages = get_flashed_messages(with_categories=true) %}
{% if messages %}

<div class="flash-wrapper">

{% for category,message in messages %}

<div class="flash-card">

<div class="flash-icon flash-{{category}}">

{% if category=="success" %}
<i class="fa-solid fa-check"></i>

{% elif category=="danger" %}
<i class="fa-solid fa-xmark"></i>

{% else %}
<i class="fa-solid fa-circle-info"></i>

{% endif %}

</div>

<h5 class="fw-bold mb-2">

{% if category=="success" %}
Success

{% elif category=="danger" %}
Error

{% else %}
Notice

{% endif %}

</h5>

<p class="text-muted mb-0">
{{message}}
</p>

</div>

{% endfor %}

</div>

{% endif %}
{% endwith %}



<!-- ================= CONFIRM MODAL ================= -->

<div class="modal fade" id="confirmModal">

<div class="modal-dialog modal-dialog-centered">

<div class="modal-content">

<div class="modal-header bg-danger text-white">

<h5 class="modal-title">Confirm Action</h5>

<button class="btn-close" data-bs-dismiss="modal"></button>

</div>

<div class="modal-body">
Are you sure you want to perform this action?
</div>

<div class="modal-footer">

<button class="btn btn-secondary" data-bs-dismiss="modal">
Cancel
</button>

<a href="#" id="confirmBtn" class="btn btn-danger">
OK
</a>

</div>

</div>

</div>

</div>

<!-- LOGIN REQUIRED CARD -->

<div id="loginRequiredCard" class="flash-wrapper" style="display:none;">

<div class="flash-card">

<div class="flash-icon flash-danger">
<i class="fa-solid fa-user-lock"></i>
</div>

<h5 class="fw-bold mb-2">Login Required</h5>

<p class="text-muted mb-3">
Please login to verify products
</p>

<a href="/login" class="btn btn-dark px-4">
Login
</a>

</div>

</div>


<!-- ================= FOOTER ================= -->

<footer class="footer mt-auto">

<div class="container">

<div class="row">

<div class="col-md-4 mb-3">
<h5>BlockAuth</h5>
<p>Blockchain-based fake product authentication system.</p>
</div>

<div class="col-md-4 mb-3">

<h6>Quick Links</h6>

<ul class="list-unstyled">

<li><a href="/">Home</a></li>
<li><a href="#" onclick="handleVerifyClick()">Verify Product</a></li>
<li><a href="/login">Login</a></li>
<li><a href="/register">Register</a></li>

</ul>

</div>

<div class="col-md-4 mb-3">

<h6>Project Info</h6>

<p>
Final Year Engineering Project<br>
Blockchain & Cloud Computing
</p>

</div>

</div>

<hr>

<p class="text-center mb-0">
Â© 2026 BlockAuth. All rights reserved.
</p>

</div>

</footer>



<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>



<script>

function handleVerifyClick()
{

const loggedIn =
{{ (session.get("user") is not none) | tojson }};

if(loggedIn)
{
window.location.href = "/verify";
}
else
{
const card =
document.getElementById("loginRequiredCard");

card.style.display="flex";

setTimeout(()=>{
card.style.display="none";
},1000);

}

}



/* AUTO CLOSE FLASH NOTIFICATIONS */

document.addEventListener("DOMContentLoaded", function(){

const flashWrapper =
document.querySelector(".flash-wrapper");

if(flashWrapper)
{
setTimeout(()=>{
flashWrapper.style.display="none";
},1000);
}

});

</script>
<script>

document.addEventListener("DOMContentLoaded", function(){

    const confirmModal =
        document.getElementById("confirmModal");

    const confirmBtn =
        document.getElementById("confirmBtn");

    confirmModal.addEventListener(
        "show.bs.modal",
        function(event)
        {

            const button =
                event.relatedTarget;

            const url =
                button.getAttribute("data-url");

            confirmBtn.href = url;

        }
    );

});

</script>
</body>
</html>
